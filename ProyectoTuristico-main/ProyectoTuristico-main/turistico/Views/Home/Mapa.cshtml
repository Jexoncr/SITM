@{
    ViewBag.Title = "Mapa Turístico";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    /* ====== Estilos específicos de la página ====== */
    .hero-map {
        background: linear-gradient(135deg, rgba(27,122,92,.12), rgba(27,122,92,.04));
        border: 1px solid rgba(27,122,92,.15);
        border-radius: 18px;
        padding: 18px;
    }

    .search-pill {
        border-radius: 999px !important;
        padding-left: 44px !important;
    }

    .search-icon {
        position: absolute;
        left: 16px;
        top: 50%;
        transform: translateY(-50%);
        opacity: .6;
        pointer-events: none;
    }

    .filter-card, .map-card, .place-card {
        border-radius: 16px;
        border: 1px solid rgba(0,0,0,.06);
    }

    .map-frame {
        border: 0;
        width: 100%;
        height: 360px;
        border-radius: 16px;
    }

    .badge-soft {
        background: rgba(25,135,84,.12) !important;
        color: #198754 !important;
        border: 1px solid rgba(25,135,84,.20);
    }

    .btn-soft-success {
        background: rgba(25,135,84,.10);
        color: #198754;
        border: 1px solid rgba(25,135,84,.25);
    }

        .btn-soft-success:hover {
            background: rgba(25,135,84,.16);
            color: #146c43;
        }

    .place-title {
        line-height: 1.2;
    }
</style>

<div class="container py-3 py-lg-4">

    <!-- HERO / CABECERA -->
    <div class="hero-map mb-4 shadow-sm">
        <div class="d-flex flex-column flex-lg-row align-items-start align-items-lg-center justify-content-between gap-3">
            <div>
                <h2 class="fw-bold text-success mb-1">Mapa Turístico</h2>
                <p class="text-muted fs-6 mb-0">
                    Explorá atractivos del cantón con búsqueda, categorías y ubicación en el mapa.
                </p>
            </div>

            <!-- BUSCADOR -->
            <form class="w-100 w-lg-50" onsubmit="return false;">
                <div class="position-relative">
                    <span class="search-icon">🔎</span>
                    <input id="searchInput" type="text"
                           class="form-control form-control-lg search-pill shadow-sm"
                           placeholder="Buscar lugares (ej: cascada, hotel, restaurante ...)">
                </div>
                <div class="d-flex gap-2 mt-2 flex-wrap">
                    <button id="btnClear" class="btn btn-sm btn-outline-secondary rounded-pill" type="button">Limpiar</button>
                    
                </div>
            </form>
        </div>
    </div>

    <div class="row g-4">

        <!-- FILTROS -->
        <div class="col-lg-3">
            <div class="card filter-card shadow-sm">
                <div class="card-body">
                    <div class="d-flex align-items-center justify-content-between mb-2">
                        <h5 class="fw-bold text-success mb-0">Filtros</h5>
                        <span class="badge badge-soft rounded-pill">Categorías</span>
                    </div>

                    <div class="vstack gap-2 mt-3">
                        <div class="form-check">
                            <input class="form-check-input filterCheck" type="checkbox" value="Naturaleza" checked id="f1">
                            <label class="form-check-label" for="f1">Naturaleza</label>
                        </div>

                        <div class="form-check">
                            <input class="form-check-input filterCheck" type="checkbox" value="Gastronomía" checked id="f2">
                            <label class="form-check-label" for="f2">Gastronomía</label>
                        </div>

                        <div class="form-check">
                            <input class="form-check-input filterCheck" type="checkbox" value="Cultura" checked id="f3">
                            <label class="form-check-label" for="f3">Cultura</label>
                        </div>

                        <div class="form-check">
                            <input class="form-check-input filterCheck" type="checkbox" value="Hospedaje" checked id="f4">
                            <label class="form-check-label" for="f4">Hospedaje</label>
                        </div>

                        <div class="form-check">
                            <input class="form-check-input filterCheck" type="checkbox" value="Aventura" checked id="f5">
                            <label class="form-check-label" for="f5">Aventura</label>
                        </div>
                    </div>

                    <hr class="my-3">

                    <button id="btnApply" class="btn btn-success w-100 rounded-pill" type="button">
                        Aplicar filtros
                    </button>

                    <button id="btnReset" class="btn btn-soft-success w-100 rounded-pill mt-2" type="button">
                        Restablecer
                    </button>
                </div>
            </div>
        </div>

        <!-- MAPA + LISTADO -->
        <div class="col-lg-9">

            <!-- MAPA (GOOGLE MAPS IFRAME) -->
            <div class="card map-card shadow-sm mb-4 overflow-hidden">
                <div class="card-body p-2 p-md-3">
                    <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-2">
                        <div class="fw-semibold text-success">Mapa</div>
                        <div class="text-muted small">Podés incrustar el mapa del cantón (o un lugar específico).</div>
                    </div>

                   
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d62945.40272181664!2d-84.5246177!3d10.3320378!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8fa0f5a2e9c6a93f%3A0x6b5c4e2b9b5a6c7!2sSan%20Carlos%2C%20Alajuela!5e0!3m2!1ses!2scr!4v1700000000000"
                            width="100%"
                            height="350"
                            style="border:0; border-radius:16px;"
                            allowfullscreen=""
                            loading="lazy"
                            referrerpolicy="no-referrer-when-downgrade">
                    </iframe>

                </div>
            </div>

            <!-- LISTADO -->
            <div class="d-flex align-items-center justify-content-between mb-3">
                <h5 class="fw-bold mb-0">Lugares</h5>
                <span id="resultCount" class="text-muted small"></span>
            </div>

            <div id="placesGrid" class="row g-4 row-cols-1 row-cols-md-2 row-cols-lg-3">

                <!-- LUGAR 1 -->
                <div class="col place-item" data-name="Cascada El Encanto" data-cat="Naturaleza">
                    <div class="card place-card h-100 shadow-sm">
                        <div class="card-body">
                            <h6 class="fw-bold text-success place-title mb-2">Cascada El Encanto</h6>
                            <p class="text-muted mb-2">Atractivo natural rodeado de bosque.</p>
                            <span class="badge rounded-pill badge-soft">Naturaleza</span>

                            <div class="mt-3 d-flex gap-2">
                                <a href="#" class="btn btn-outline-success btn-sm rounded-pill">Ver detalle</a>
                                <button type="button" class="btn btn-success btn-sm rounded-pill">Ubicar</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- LUGAR 2 -->
                <div class="col place-item" data-name="Restaurante Sabores Típicos" data-cat="Gastronomía">
                    <div class="card place-card h-100 shadow-sm">
                        <div class="card-body">
                            <h6 class="fw-bold text-success place-title mb-2">Restaurante Sabores Típicos</h6>
                            <p class="text-muted mb-2">Comida tradicional costarricense.</p>
                            <span class="badge rounded-pill badge-soft">Gastronomía</span>

                            <div class="mt-3 d-flex gap-2">
                                <a href="#" class="btn btn-outline-success btn-sm rounded-pill">Ver detalle</a>
                                <button type="button" class="btn btn-success btn-sm rounded-pill">Ubicar</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- LUGAR 3 -->
                <div class="col place-item" data-name="Casa Histórica Municipal" data-cat="Cultura">
                    <div class="card place-card h-100 shadow-sm">
                        <div class="card-body">
                            <h6 class="fw-bold text-success place-title mb-2">Casa Histórico Municipal</h6>
                            <p class="text-muted mb-2">Patrimonio cultural del cantón.</p>
                            <span class="badge rounded-pill badge-soft">Cultura</span>

                            <div class="mt-3 d-flex gap-2">
                                <a href="#" class="btn btn-outline-success btn-sm rounded-pill">Ver detalle</a>
                                <button type="button" class="btn btn-success btn-sm rounded-pill">Ubicar</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- LUGAR 4 -->
                <div class="col place-item" data-name="Hotel Mirador Verde" data-cat="Hospedaje">
                    <div class="card place-card h-100 shadow-sm">
                        <div class="card-body">
                            <h6 class="fw-bold text-success place-title mb-2">Hotel Mirador Verde</h6>
                            <p class="text-muted mb-2">Hospedaje con vista panorámica.</p>
                            <span class="badge rounded-pill badge-soft">Hospedaje</span>

                            <div class="mt-3 d-flex gap-2">
                                <a href="#" class="btn btn-outline-success btn-sm rounded-pill">Ver detalle</a>
                                <button type="button" class="btn btn-success btn-sm rounded-pill">Ubicar</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- LUGAR 5 -->
                <div class="col place-item" data-name="Sendero Los Robles" data-cat="Aventura">
                    <div class="card place-card h-100 shadow-sm">
                        <div class="card-body">
                            <h6 class="fw-bold text-success place-title mb-2">Sendero Los Robles</h6>
                            <p class="text-muted mb-2">Ruta de caminata ecológica.</p>
                            <span class="badge rounded-pill badge-soft">Aventura</span>

                            <div class="mt-3 d-flex gap-2">
                                <a href="#" class="btn btn-outline-success btn-sm rounded-pill">Ver detalle</a>
                                <button type="button" class="btn btn-success btn-sm rounded-pill">Ubicar</button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>
</div>

<script>
    // ====== Buscador + filtros (front-end simple) ======
    const searchInput = document.getElementById("searchInput");
    const btnClear = document.getElementById("btnClear");
    const btnApply = document.getElementById("btnApply");
    const btnReset = document.getElementById("btnReset");
    const resultCount = document.getElementById("resultCount");

    function getSelectedCategories() {
        return Array.from(document.querySelectorAll(".filterCheck"))
            .filter(cb => cb.checked)
            .map(cb => cb.value);
    }

    function applyFilters() {
        const q = (searchInput.value || "").trim().toLowerCase();
        const cats = getSelectedCategories();
        const items = Array.from(document.querySelectorAll(".place-item"));

        let visible = 0;

        items.forEach(el => {
            const name = (el.getAttribute("data-name") || "").toLowerCase();
            const cat = el.getAttribute("data-cat") || "";

            const matchSearch = q === "" || name.includes(q);
            const matchCat = cats.length === 0 ? true : cats.includes(cat);

            const show = matchSearch && matchCat;
            el.style.display = show ? "" : "none";
            if (show) visible++;
        });

        resultCount.textContent = `${visible} resultado(s)`;
    }

    // Buscar en tiempo real
    searchInput.addEventListener("input", applyFilters);

    // Botones
    btnClear.addEventListener("click", () => {
        searchInput.value = "";
        applyFilters();
        searchInput.focus();
    });

    btnApply.addEventListener("click", applyFilters);

    btnReset.addEventListener("click", () => {
        document.querySelectorAll(".filterCheck").forEach(cb => cb.checked = true);
        searchInput.value = "";
        applyFilters();
    });

    // Inicial
    applyFilters();
</script>
